# rule: Component – Tooltip
type: auto_attached
scope: **/*
---
## Overview
Short purpose and when-to-use guidance for **Tooltip**.

## Anatomy
- Structure and slots (leading/trailing/media/actions/meta if applicable).

## Props (typed)
- List key props with types, defaults, and constraints.

## States
- Hover, focus, active, disabled, loading, invalid.

## Accessibility
- Roles, labels, keyboard, focus outline, ARIA attributes.

## Usage Examples
- Basic usage
- With slots (icon/text/secondary action)
- Edge cases (long text, truncation)

## Do / Don't
- Do: keep API surface small; reuse Foundations tokens.
- Don't: hardcode colors; expose unstable DOM structure.

## Notes
Merged documentation from repository and component docs (if present).

---

### Source Docs
# Tooltip

## Visão geral

`Tooltip` exibe informações suplementares quando o utilizador passa o cursor ou foca um elemento.  Utiliza posicionamento inteligente, permite configurar atrasos de mostrar/ocultar e suporta conteúdo rico【853686467329010†L17-L24】.

## Funcionalidades principais

- **Posicionamento inteligente**: ajusta automaticamente a posição para se manter visível【853686467329010†L19-L23】.
- **Atrasos configuráveis**: permite definir atrasos de entrada (`delayIn`) e saída (`delayOut`) para evitar cintilação【853686467329010†L20-L21】【853686467329010†L63-L72】.
- **Suporte a grupo**: tooltips podem coordenar‑se em grupo para remover atrasos quando há vários próximos【853686467329010†L21-L22】【853686467329010†L90-L94】.
- **Conteúdo rico**: aceita qualquer `ReactNode`, incluindo texto longo ou componentes【853686467329010†L22-L23】【853686467329010†L117-L119】.
- **Modo controlado**: permite controlar o estado aberto com `open` e `onOpenChange`【853686467329010†L23-L24】.

## Dependências

- Usa o hook `useTopLayer` para colocar o tooltip na camada superior【853686467329010†L7-L9】.
- Utiliza `@floating-ui/react` para cálculo de posição【853686467329010†L11-L13】.

## API

| Propriedade | Tipo | Predefinição | Descrição |
| --- | --- | --- | --- |
| **content** | `ReactNode` | – | Conteúdo mostrado no tooltip【853686467329010†L31-L35】. |
| **open** | `boolean` | – | Estado aberto (modo controlado)【853686467329010†L36-L39】. |
| **onOpenChange** | `(open: boolean, event?: Event, reason?: OpenChangeReason) => void` | – | Callback ao mudar o estado【853686467329010†L40-L45】. |
| **initialOpen** | `boolean` | `false` | Se o tooltip está aberto inicialmente (modo não controlado)【853686467329010†L46-L52】. |
| **placement** | `Placement` | `'top'` | Posição relativa ao activador【853686467329010†L53-L57】. |
| **offset** | `number` | `4` | Distância entre tooltip e activador【853686467329010†L58-L62】. |
| **delayIn** | `number` | `600` | Atraso em milissegundos antes de mostrar o tooltip【853686467329010†L63-L66】. |
| **delayOut** | `number` | `0` | Atraso antes de ocultar【853686467329010†L68-L72】. |
| **disabled** | `boolean` | `false` | Desactiva o tooltip【853686467329010†L74-L77】. |
| **persistOnClick** | `boolean` | `false` | Mantém o tooltip visível após clique no activador【853686467329010†L79-L84】. |

## Boas práticas

- **Conteúdo**: mantenha o conteúdo conciso; use tooltips para informações adicionais, não essenciais【853686467329010†L129-L134】.
- **Temporização**: ajuste os atrasos para evitar activações acidentais; em grupos, use `TooltipGroup` para remover atrasos ao passar de um para outro【853686467329010†L90-L97】.
- **Posicionamento**: escolha posições sensatas (por exemplo, `top` para ícones) e teste em diferentes tamanhos de ecrã【853686467329010†L141-L145】.
- **Performance**: evite colocar conteúdo pesado dentro de tooltips; opte por textos curtos ou ícones【853686467329010†L147-L148】.
- **Acessibilidade**: forneça `aria-label` ou `aria-describedby` no activador; garanta que o tooltip é acessível via teclado e não só por hover.

## Source Snapshot
_Synced from foundations-main (read-only)._

**src/foundations/ui/tooltip/tooltip.tsx**

```tsx
"use client";

import {
  arrow,
  autoUpdate,
  flip,
  FloatingArrow,
  FloatingDelayGroup,
  hide,
  offset as offsetMiddleware,
  Placement,
  safePolygon,
  useDelayGroup,
  useDismiss,
  useFloating,
  UseFloatingOptions,
  useFocus,
  useHover,
  useInteractions,
  useMergeRefs,
  useRole,
  useTransitionStatus,
} from "@floating-ui/react";
import {
  cloneElement,
  isValidElement,
  useCallback,
  useRef,
  useState,
} from "react";

import { useTopLayer } from "@/foundations/hooks/use-top-layer/use-top-layer";
import { cn } from "@/lib/utils";

// Let's keep an eye on popover="hint", it might be able to handle the tooltip logic natively
// https://developer.mozilla.org/en-US/docs/Web/API/Popover_API/Using#using_hint_popover_state

const DEFAULT_DELAY_IN = 600;
const DEFAULT_DELAY_OUT = 0;
const ARROW_HEIGHT = 4;
const ARROW_WIDTH = 8;
const DEFAULT_GROUP_TIMEOUT_MS = 150;

interface TooltipProps
  extends Omit<React.ComponentPropsWithRef<"div">, "content"> {
  initialOpen?: boolean;
  open?: boolean;
  onOpenChange?: UseFloatingOptions["onOpenChange"];
  placement?: Placement;
  offset?: number;
  delayIn?: number;
  delayOut?: number;
  disabled?: boolean;
  persistOnClick?: boolean;
  content: React.ReactNode;
  children: React.ReactNode;
}

/**
 * Tooltip component
 *
 * @example
 * ```
 * <Tooltip content="Tooltip content">
 *   <Button>Hover me</Button>
 * </Tooltip>
 * ```
 */
const Tooltip = ({
  ref,
  content,
  children,
  className,
  initialOpen = false,
  open: propsOpen,
  onOpenChange: propsOnOpenChange,
  placement = "top",
  offset = 4,
  delayIn = DEFAULT_DELAY_IN,
  delayOut = DEFAULT_DELAY_OUT,
  disabled = false,
  persistOnClick = false,
  ...props
}: TooltipProps) => {
  const arrowRef = useRef<SVGSVGElement | null>(null);
  const [internalOpen, setInternalOpen] = useState(initialOpen);

  const open = propsOpen ?? internalOpen;

  const setOpen = useCallback<NonNullable<UseFloatingOptions["onOpenChange"]>>(
    (open, event, reason) => {
      setInternalOpen(open);
      propsOnOpenChange?.(open, event, reason);
    },
    [propsOnOpenChange]
  );

  const floating = useFloating({
    placement,
    open,
    onOpenChange: setOpen,
    whileElementsMounted: autoUpdate,
    middleware: [
      flip({ fallbackAxisSideDirection: "start", padding: offset * 2 }),
      offsetMiddleware(offset + ARROW_HEIGHT),
      arrow({ element: arrowRef, padding: 8 }),
      hide(),
    ],
  });

  const ctx = floating.context;
  const { delay: groupDelay } = useDelayGroup(ctx);

  const hover = useHover(ctx, {
    enabled: !disabled,
    move: false,
    delay: {
      open: typeof groupDelay === "object" ? groupDelay.open : delayIn,
      close: typeof groupDelay === "object" ? groupDelay.close : delayOut,
    },
    handleClose: safePolygon({}),
  });

  const focus = useFocus(ctx, {
    enabled: !disabled,
  });
  const dismiss = useDismiss(ctx, {
    referencePress: !persistOnClick,
  });
  const role = useRole(ctx, { role: "tooltip" });

  const interactions = useInteractions([hover, focus, dismiss, role]);

  const { isMounted, status } = useTransitionStatus(ctx, { duration: 0 });

  const topLayerRef = useTopLayer<HTMLDivElement>(isMounted);
  const contentRef = useMergeRefs([ctx.refs.setFloating, ref, topLayerRef]);

  return (
    <>
      {isValidElement(children) ? (
        cloneElement(
          children,
          interactions.getReferenceProps({ ref: ctx.refs.setReference })
        )
      ) : (
        <span
          ref={ctx.refs.setReference}
          {...interactions.getReferenceProps(props)}
          className="inline-block outline-none"
        >
          {children}
        </span>
      )}
      {isMounted && (
        <div
          ref={contentRef}
          className={cn(
            "bg-foreground text-background ease-out-quint z-50 max-w-80 overflow-visible rounded-lg px-3 py-1.5 text-xs break-words drop-shadow-md transition duration-300",
            "data-[state=closed]:data-[side=bottom]:-translate-y-2 data-[state=closed]:data-[side=left]:translate-x-2 data-[state=closed]:data-[side=right]:-translate-x-2 data-[state=closed]:data-[side=top]:translate-y-2",
            "data-[state=closed]:scale-95 data-[state=closed]:opacity-0",
            "data-[state=open]:translate-x-0 data-[state=open]:translate-y-0 data-[state=open]:scale-100",
            floating.middlewareData.hide?.referenceHidden && "hidden",
            className
          )}
          data-state={status === "open" ? "open" : "closed"}
          data-side={ctx.placement.split("-")[0]}
          style={{
            position: ctx.strategy,
            top: ctx.y ?? 0,
            left: ctx.x ?? 0,
            ...props.style,
          }}
          {...interactions.getFloatingProps(props)}
        >
          <FloatingArrow
            ref={arrowRef}
            context={ctx}
            className="fill-foreground"
            tipRadius={1}
            height={ARROW_HEIGHT}
            width={ARROW_WIDTH}
          />
          {content}
        </div>
      )}
    </>
  );
};

interface TooltipGroupProps {
  children: React.ReactNode;
  delayIn?: number;
  delayOut?: number;
  timeoutMs?: number;
}

/**
 * TooltipGroup allows you to group tooltips so they won't have delay when you move between them.
 *
 * This is very useful for navigation or toolbars where you want the first tooltip to have significant delay but moving to the next item should be instant so the user can scan all options.
 *
 * @example
 * ```
 * <TooltipGroup>
 *   <div className="flex gap-2">
 *     {tools.map((tool) => (
 *       <Tooltip key={tool.id} content={tool.label}>
 *         <Button>{tool.icon}</Button>
 *       </Tooltip>
 *     ))}
 *   </div>
 * </TooltipGroup>
 * ```
 */

const TooltipGroup = ({
  delayIn = DEFAULT_DELAY_IN,
  delayOut = DEFAULT_DELAY_OUT,
  timeoutMs = DEFAULT_GROUP_TIMEOUT_MS,
  children,
}: TooltipGroupProps) => {
  return (
    <FloatingDelayGroup
      delay={{ open: delayIn, close: delayOut }}
      timeoutMs={timeoutMs}
    >
      {children}
    </FloatingDelayGroup>
  );
};

export { Tooltip, TooltipGroup };

```

**src/foundations/ui/tooltip/examples/tooltip-group.preview.tsx**

```tsx
import { ClipboardIcon, ScissorsIcon } from "@phosphor-icons/react/dist/ssr";

import { Button } from "@/foundations/ui/button/button";
import { Tooltip, TooltipGroup } from "@/foundations/ui/tooltip/tooltip";

export default function TooltipGroupPreview() {
  return (
    <div className="flex items-center gap-2">
      <TooltipGroup>
        <Tooltip content="Copy">
          <Button variant="outline" size="sm" square>
            <ClipboardIcon />
          </Button>
        </Tooltip>
        <Tooltip content="Cut">
          <Button variant="outline" size="sm" square>
            <ScissorsIcon />
          </Button>
        </Tooltip>
      </TooltipGroup>
    </div>
  );
}

```

**src/foundations/ui/tooltip/examples/tooltip-persist-click.preview.tsx**

```tsx
"use client";

import { ClipboardIcon } from "@phosphor-icons/react";
import { useEffect, useState } from "react";

import { Button } from "@/foundations/ui/button/button";
import { Tooltip } from "@/foundations/ui/tooltip/tooltip";

export default function TooltipPersistClickPreview() {
  const [copied, setCopied] = useState(false);

  useEffect(() => {
    let timeout: ReturnType<typeof setTimeout>;
    if (copied) {
      timeout = setTimeout(() => {
        setCopied(false);
      }, 2000);
    }

    return () => clearTimeout(timeout);
  }, [copied]);

  return (
    <Tooltip
      persistOnClick
      delayIn={0}
      content={copied ? "Copied!" : "Copy"}
      onOpenChange={(open) => {
        if (!open) setCopied(false);
      }}
    >
      <Button
        variant="outline"
        square
        size="sm"
        onClick={() => setCopied(true)}
        aria-label="Copy"
      >
        <ClipboardIcon />
      </Button>
    </Tooltip>
  );
}

```

**src/foundations/ui/tooltip/examples/tooltip.preview.tsx**

```tsx
import { Tooltip } from "@/foundations/ui/tooltip/tooltip";

export default function TooltipPreview() {
  return <Tooltip content="Or is there?">Nothing to see here</Tooltip>;
}

```

**src/foundations/ui/tooltip/examples/tooltip-placement.preview.tsx**

```tsx
import { Button } from "@/foundations/ui/button/button";
import { Tooltip, TooltipGroup } from "@/foundations/ui/tooltip/tooltip";

export default function TooltipPlacementPreview() {
  return (
    <div className="flex w-full flex-col gap-2 overflow-auto p-2">
      <TooltipGroup>
        <Tooltip content="Top" placement="top">
          <Button variant="outline" size="sm">
            Top
          </Button>
        </Tooltip>
        <Tooltip content="Right" placement="right">
          <Button variant="outline" size="sm">
            Right
          </Button>
        </Tooltip>
        <Tooltip content="Bottom" placement="bottom">
          <Button variant="outline" size="sm">
            Bottom
          </Button>
        </Tooltip>
        <Tooltip content="Left" placement="left">
          <Button variant="outline" size="sm">
            Left
          </Button>
        </Tooltip>
        <Tooltip content="Top Start" placement="top-start">
          <Button variant="outline" size="sm">
            Top Start
          </Button>
        </Tooltip>
        <Tooltip content="Top End" placement="top-end">
          <Button variant="outline" size="sm">
            Top End
          </Button>
        </Tooltip>
        <Tooltip content="Right Start" placement="right-start">
          <Button variant="outline" size="sm">
            Right Start
          </Button>
        </Tooltip>
        <Tooltip content="Right End" placement="right-end">
          <Button variant="outline" size="sm">
            Right End
          </Button>
        </Tooltip>
        <Tooltip content="Bottom Start" placement="bottom-start">
          <Button variant="outline" size="sm">
            Bottom Start
          </Button>
        </Tooltip>
        <Tooltip content="Bottom End" placement="bottom-end">
          <Button variant="outline" size="sm">
            Bottom End
          </Button>
        </Tooltip>
        <Tooltip content="Left Start" placement="left-start">
          <Button variant="outline" size="sm">
            Left Start
          </Button>
        </Tooltip>
        <Tooltip content="Left End" placement="left-end">
          <Button variant="outline" size="sm">
            Left End
          </Button>
        </Tooltip>
      </TooltipGroup>
    </div>
  );
}

```

**src/foundations/ui/tooltip/examples/tooltip-scroll.preview.tsx**

```tsx
import { Tooltip } from "@/foundations/ui/tooltip/tooltip";

export default function TooltipScrollPreview() {
  return (
    <div className="h-full w-full overflow-y-auto">
      <div className="flex h-[200vh] items-center justify-center">
        <Tooltip content="Tooltip content" open>
          Scroll to see the tooltip reposition itself
        </Tooltip>
      </div>
    </div>
  );
}

```
