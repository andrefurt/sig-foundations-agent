# rule: Component – Input
type: auto_attached
scope: **/*
---
## Overview
Short purpose and when-to-use guidance for **Input**.

## Anatomy
- Structure and slots (leading/trailing/media/actions/meta if applicable).

## Props (typed)
- List key props with types, defaults, and constraints.

## States
- Hover, focus, active, disabled, loading, invalid.

## Accessibility
- Roles, labels, keyboard, focus outline, ARIA attributes.

## Usage Examples
- Basic usage
- With slots (icon/text/secondary action)
- Edge cases (long text, truncation)

## Do / Don't
- Do: keep API surface small; reuse Foundations tokens.
- Don't: hardcode colors; expose unstable DOM structure.

## Notes
Merged documentation from repository and component docs (if present).

---

### Source Docs
# Input

## Visão geral

`Input` é um campo de texto simples com suporte para variantes visuais, estados de validação e componentes adicionais como prefixos e sufixos.  Serve como base para a maioria dos controlos de entrada na biblioteca【740426274653144†L15-L19】.

## Funcionalidades principais

- **Variantes múltiplas**: estilos `default` e `minimal` para se adaptar a diferentes contextos visuais【740426274653144†L15-L16】.
- **Estados de validação**: suporta estado inválido (`invalid`), exibindo estilos específicos【740426274653144†L16-L17】.
- **Addons flexíveis**: prefixos e sufixos podem conter ícones, texto ou botões; podem ser interactivos【740426274653144†L18-L20】.

## Dependências

- Utiliza o utilitário `composeRefs` para combinar referências de DOM【740426274653144†L6-L10】.

## Anatomia

```tsx
<InputGroup>
  <InputPrefix />
  <Input />
  <InputSuffix />
</InputGroup>
```【740426274653144†L21-L29】

- **InputGroup**: contêiner para agrupar o campo e os addons【740426274653144†L52-L57】.
- **InputPrefix** e **InputSuffix**: elementos que estendem `div`; podem ser personalizados e suportam `asChild`【740426274653144†L58-L80】.

## API (Input)

| Propriedade | Tipo | Predefinição | Descrição |
| --- | --- | --- | --- |
| **variant** | `'default'` ou `'minimal'` | `'default'` | Estilo visual do campo【740426274653144†L39-L43】. |
| **invalid** | `boolean` | `false` | Indica que o valor está inválido, aplicando estilos de erro【740426274653144†L44-L47】. |

## API (InputPrefix/InputSuffix)

| Propriedade | Tipo | Descrição |
| --- | --- | --- |
| **asChild** | `boolean` | Quando `true`, permite renderizar um elemento personalizado absorvendo as props【740426274653144†L63-L80】. |

## Boas práticas

- **Validação**: forneça mensagens de erro claras e utilize tipos de input adequados (por exemplo `email`, `number`)【740426274653144†L134-L137】.
- **Addons**: mantenha ícones e textos relevantes e considere `aria-label` quando usar elementos interactivos no sufixo【740426274653144†L139-L142】.
- **Consistência**: mantenha a largura do input alinhada com outros campos do formulário e ajuste o tamanho dos addons para harmonizar com o texto【740426274653144†L134-L142】.

## Source Snapshot
_Synced from foundations-main (read-only)._

**src/foundations/ui/input/input.tsx**

```tsx
"use client";

import { VariantProps } from "cva";
import {
  Children,
  createContext,
  isValidElement,
  use,
  useLayoutEffect,
  useRef,
  useState,
} from "react";

import { Slot } from "@/foundations/components/slot/slot";
import { composeRefs } from "@/foundations/utils/compose-refs/compose-refs";
import { cn, cva } from "@/lib/utils";

const inputStyle = cva({
  base: [
    "transition",
    "w-full border h-10 rounded-xl px-4 py-1 text-base font-medium",
    "focus:outline-none focus-visible:border-accent focus-visible:ring-4 focus-visible:ring-ring focus-visible:text-foreground disabled:cursor-not-allowed disabled:opacity-50 text-foreground/80 placeholder:text-foreground-secondary data-invalid:border-red-500 data-invalid:hover:border-red-600 data-invalid:focus-visible:border-red-500 data-invalid:focus-visible:ring-red-500/20",
    "pl-(--prefix-width,calc(var(--spacing)*4))",
    "pr-(--suffix-width,calc(var(--spacing)*4))",
  ],
  variants: {
    variant: {
      default:
        "border-border bg-background hover:border-mix-border/8 shadow-xs",
      minimal:
        "border-transparent bg-transparent hover:bg-background-secondary focus-visible:bg-background",
    },
  },
  defaultVariants: {
    variant: "default",
  },
});

interface InputProps
  extends Omit<React.ComponentPropsWithRef<"input">, "size"> {
  invalid?: boolean;
  variant?: VariantProps<typeof inputStyle>["variant"];
}

const Input = ({ className, invalid, variant, ...props }: InputProps) => {
  return (
    <input
      data-invalid={invalid}
      aria-invalid={invalid}
      className={cn(inputStyle({ variant }), className)}
      {...props}
    />
  );
};

interface InputGroupContextType {
  prefixWidth: number;
  suffixWidth: number;
  setPrefixWidth: (width: number) => void;
  setSuffixWidth: (width: number) => void;
}

const InputGroupContext = createContext<InputGroupContextType>({
  prefixWidth: 0,
  suffixWidth: 0,
  setPrefixWidth: () => {},
  setSuffixWidth: () => {},
});

const useInputGroup = () => {
  const ctx = use(InputGroupContext);

  if (!ctx) {
    throw new Error("InputGroup must be used within an InputGroupContext");
  }

  return ctx;
};

const InputGroup = ({
  className,
  style,
  ...props
}: React.ComponentPropsWithRef<"div">) => {
  const [prefixWidth, setPrefixWidth] = useState(0);
  const [suffixWidth, setSuffixWidth] = useState(0);

  // check if there are more than one InputPrefix or InputSuffix
  const tooManyPrefixes =
    Children.toArray(props.children).filter(
      (child) => isValidElement(child) && child.type === InputPrefix
    ).length > 1;

  const tooManySuffixes =
    Children.toArray(props.children).filter(
      (child) => isValidElement(child) && child.type === InputSuffix
    ).length > 1;

  if (tooManyPrefixes || tooManySuffixes) {
    throw new Error(
      "InputGroup cannot have more than one InputPrefix or InputSuffix"
    );
  }

  return (
    <InputGroupContext
      value={{ prefixWidth, suffixWidth, setPrefixWidth, setSuffixWidth }}
    >
      <div
        className={cn("relative", className)}
        style={{
          ...(prefixWidth > 0 && {
            "--prefix-width": `calc(${prefixWidth}px + var(--spacing)*5.5)`,
          }),
          ...(suffixWidth > 0 && {
            "--suffix-width": `calc(${suffixWidth}px + var(--spacing)*5.5)`,
          }),
          ...style,
        }}
        {...props}
      />
    </InputGroupContext>
  );
};

interface InputPrefixProps extends React.ComponentPropsWithRef<"div"> {
  asChild?: boolean;
}

const InputPrefix = (props: InputPrefixProps) => {
  const { setPrefixWidth } = useInputGroup();

  return <InputAddon {...props} onSetWidth={setPrefixWidth} />;
};

interface InputSuffixProps extends React.ComponentPropsWithRef<"div"> {
  asChild?: boolean;
}

const InputSuffix = (props: InputSuffixProps) => {
  const { setSuffixWidth } = useInputGroup();

  return <InputAddon {...props} onSetWidth={setSuffixWidth} />;
};

interface InputAddonProps extends React.ComponentPropsWithRef<"div"> {
  onSetWidth?: (width: number) => void;
  asChild?: boolean;
}

const InputAddon = ({
  ref,
  className,
  onSetWidth,
  asChild,
  ...props
}: InputAddonProps) => {
  const Comp = asChild ? Slot : "div";
  const internalRef = useRef<HTMLDivElement | null>(null);

  useLayoutEffect(() => {
    onSetWidth?.(internalRef.current?.offsetWidth ?? 0);

    const observer = new ResizeObserver(([entry]) => {
      if (entry?.contentRect.width) {
        onSetWidth?.(Math.round(entry.contentRect.width));
      }
    });

    if (internalRef.current) {
      observer.observe(internalRef.current);
    }

    return () => observer.disconnect();
  }, [onSetWidth]);

  return (
    <Comp
      data-input-addon
      className={cn(
        "absolute top-1/2 flex -translate-y-1/2 items-center justify-center text-base font-medium",
        "text-foreground pointer-events-none first:left-4 last:right-4",
        className
      )}
      ref={composeRefs(ref, internalRef)}
      {...props}
    />
  );
};

export { Input, InputGroup, InputPrefix, inputStyle, InputSuffix };

```

**src/foundations/ui/input/examples/input-invalid.preview.tsx**

```tsx
import { Input } from "@/foundations/ui/input/input";

export default function InputInvalid() {
  return (
    <div className="w-90">
      <Input placeholder="Type something..." defaultValue="Pedro" invalid />
    </div>
  );
}

```

**src/foundations/ui/input/examples/input-icon.preview.tsx**

```tsx
import { MagnifyingGlassIcon } from "@phosphor-icons/react/dist/ssr";

import { Input, InputGroup, InputPrefix } from "@/foundations/ui/input/input";

export default function InputIcon() {
  return (
    <div className="w-90">
      <InputGroup>
        <InputPrefix>
          <MagnifyingGlassIcon />
        </InputPrefix>
        <Input placeholder="Search something" />
      </InputGroup>
    </div>
  );
}

```

**src/foundations/ui/input/examples/input.preview.tsx**

```tsx
import { Input } from "@/foundations/ui/input/input";

export default function InputExample() {
  return (
    <div className="w-90">
      <Input placeholder="Type something..." />
    </div>
  );
}

```

**src/foundations/ui/input/examples/input-disabled.preview.tsx**

```tsx
import { Input } from "@/foundations/ui/input/input";

export default function InputDisabled() {
  return (
    <div className="w-90">
      <Input placeholder="Type something..." disabled />
    </div>
  );
}

```

**src/foundations/ui/input/examples/input-icon-action.preview.tsx**

```tsx
"use client";

import { EyeClosedIcon, EyeIcon, LockIcon } from "@phosphor-icons/react";
import { useState } from "react";

import {
  Input,
  InputGroup,
  InputPrefix,
  InputSuffix,
} from "@/foundations/ui/input/input";

export default function InputIconAction() {
  const [showPassword, setShowPassword] = useState(false);

  return (
    <div className="w-90">
      <InputGroup>
        <InputPrefix>
          <LockIcon />
        </InputPrefix>
        <Input
          type={showPassword ? "text" : "password"}
          placeholder="Your password here"
        />
        <InputSuffix className="pointer-events-auto">
          <button
            className="cursor-pointer"
            onClick={() => setShowPassword(!showPassword)}
          >
            {showPassword ? <EyeIcon /> : <EyeClosedIcon />}
          </button>
        </InputSuffix>
      </InputGroup>
    </div>
  );
}

```
