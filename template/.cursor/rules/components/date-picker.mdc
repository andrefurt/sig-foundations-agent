# rule: Component – Date Picker
type: intelligent
scope: **/*
---
## Overview
Short purpose and when-to-use guidance for **Date Picker**.

## Anatomy
- Structure and slots (leading/trailing/media/actions/meta if applicable).

## Props (typed)
- List key props with types, defaults, and constraints.

## States
- Hover, focus, active, disabled, loading, invalid.

## Accessibility
- Roles, labels, keyboard, focus outline, ARIA attributes.

## Usage Examples
- Basic usage
- With slots (icon/text/secondary action)
- Edge cases (long text, truncation)

## Do / Don't
- Do: keep API surface small; reuse Foundations tokens.
- Don't: hardcode colors; expose unstable DOM structure.

## Notes
Merged documentation from repository and component docs (if present).

---

### Source Docs
# Date Picker

## Visão geral

`DatePicker` combina o `Calendar` e o `Dropdown` para fornecer um campo de entrada com seletor de data.  Suporta diferentes variantes visuais, atalhos de datas e posicionamento inteligente do painel【41537526133641†L23-L28】.

## Funcionalidades principais

- **Entrada flexível**: permite variantes de estilo consistentes com o componente `Input` e placeholders personalizados【41537526133641†L23-L28】.
- **Atalhos**: oferece atalhos predefinidos para seleccionar rapidamente intervalos comuns (ex. hoje, última semana)【41537526133641†L25-L27】.
- **Posicionamento inteligente**: ajusta automaticamente a posição do painel para se manter visível【41537526133641†L27-L28】.
- **Navegação por teclado**: herda suporte completo do `Calendar`【41537526133641†L23-L29】.

## Dependências

- `Calendar`【41537526133641†L9-L12】.
- `Dropdown`【41537526133641†L13-L15】.
- Estilos de `Input` para alinhar a aparência【41537526133641†L17-L19】.

## Anatomia

```tsx
<DatePicker>
  <DatePickerTrigger />
  <DatePickerPanel />
</DatePicker>
```【41537526133641†L32-L37】

- **DatePicker**: container principal que estende `Dropdown`【41537526133641†L41-L45】.
- **DatePickerTrigger**: botão que abre o painel; estende `DropdownTrigger`【41537526133641†L45-L49】.
- **DatePickerPanel**: painel que contém o `Calendar`; estende `Calendar`【41537526133641†L63-L66】.

## API (props de `DatePicker`)

| Propriedade | Tipo | Descrição |
| --- | --- | --- |
| **placeholder** | `string` | Texto exibido quando não há data seleccionada【41537526133641†L50-L55】. |
| **variant** | `InputProps['variant']` | Variante visual do `Input` associado【41537526133641†L56-L59】. |

Outras propriedades são herdadas dos componentes `Dropdown` e `Calendar`.

## Boas práticas

- **Formato de entrada**: utilize padrões claros e adicione dicas no placeholder para evitar confusão sobre o formato de data【41537526133641†L89-L93】.
- **Atalhos**: seleccione atalhos relevantes para o contexto (por exemplo, “últimos 7 dias” em dashboards) e use rótulos descritivos【41537526133641†L95-L99】.
- **Dispositivos móveis**: teste interacções táctteis e considere usar componentes nativos de data em dispositivos móveis【41537526133641†L101-L103】.

## Source Snapshot
_Synced from foundations-main (read-only)._

**src/foundations/ui/date-picker/date-picker.tsx**

```tsx
"use client";

import { CalendarIcon, CaretUpDownIcon } from "@phosphor-icons/react";
import { VariantProps } from "cva";

import { Calendar } from "@/foundations/ui/calendar/calendar";
import {
  Dropdown,
  DropdownItems,
  DropdownTrigger,
  useDropdownContext,
} from "@/foundations/ui/dropdown/dropdown";
import { inputStyle } from "@/foundations/ui/input/input";
import { cn } from "@/lib/utils";

const DatePicker = ({
  children,
  ...props
}: React.ComponentProps<typeof Dropdown>) => {
  return <Dropdown {...props}>{children}</Dropdown>;
};

interface DatePickerTriggerProps
  extends React.ComponentProps<typeof DropdownTrigger> {
  className?: string;
  children: React.ReactNode;
  variant?: VariantProps<typeof inputStyle>["variant"];
  placeholder?: string;
}

const DatePickerTrigger = ({
  children,
  className,
  variant,
  placeholder,
  ...props
}: DatePickerTriggerProps) => {
  return (
    <DropdownTrigger asChild {...props}>
      <button
        type="button"
        className={cn(
          inputStyle({ variant }),
          "flex items-center gap-1.5 enabled:cursor-pointer",
          "relative w-full pr-10 pl-4",
          className
        )}
      >
        <CalendarIcon className="text-foreground-secondary shrink-0" />
        {children ?? (
          <span className="text-foreground-secondary">{placeholder}</span>
        )}
        <CaretUpDownIcon
          weight="bold"
          className="text-foreground/80 absolute top-1/2 right-3 -translate-y-1/2 text-base"
        />
      </button>
    </DropdownTrigger>
  );
};

interface DatePickerContentCommonProps
  extends Omit<
    React.ComponentPropsWithRef<typeof Calendar>,
    "mode" | "value" | "onDateChange"
  > {
  className?: string;
  children?: React.ReactNode;
}

interface DatePickerContentSingleProps extends DatePickerContentCommonProps {
  mode?: "single";
  value: Date | null;
  onDateChange: (date: Date) => void;
}

interface DatePickerContentRangeProps extends DatePickerContentCommonProps {
  mode: "range";
  value: [Date, Date] | null;
  onDateChange: (dates: [Date, Date]) => void;
}

type DatePickerContentProps =
  | DatePickerContentSingleProps
  | DatePickerContentRangeProps;

const DatePickerPanel = ({
  className,
  children,
  mode,
  value,
  onDateChange,
  ...props
}: DatePickerContentProps) => {
  const { setOpen } = useDropdownContext();

  return (
    <DropdownItems className={cn(className)}>
      <Calendar
        {...props}
        mode={mode}
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        value={value as any}
        onDateChange={(date: Date | [Date, Date]) => {
          setOpen(false);
          // eslint-disable-next-line @typescript-eslint/no-explicit-any
          onDateChange(date as any);
        }}
      />
      {children}
    </DropdownItems>
  );
};

export { DatePicker, DatePickerPanel, DatePickerTrigger };

```

**src/foundations/ui/date-picker/examples/date-picker-date-time.preview.tsx**

```tsx
"use client";

import { format } from "date-fns";
import { useState } from "react";

import {
  DatePicker,
  DatePickerPanel,
  DatePickerTrigger,
} from "@/foundations/ui/date-picker/date-picker";
import { Input } from "@/foundations/ui/input/input";

export default function DatePickerDateTimePreview() {
  const [selectedDate, setSelectedDate] = useState<Date>(new Date());

  return (
    <div className="flex items-center gap-2">
      <DatePicker placement="bottom-start">
        <DatePickerTrigger className="w-60" placeholder="Select date">
          {format(selectedDate, "PPP")}
        </DatePickerTrigger>
        <DatePickerPanel
          className="w-72"
          value={selectedDate || new Date()}
          onDateChange={(date: Date) => {
            setSelectedDate(date);
          }}
        />
      </DatePicker>
      <Input className="w-40" type="time" />
    </div>
  );
}

```

**src/foundations/ui/date-picker/examples/date-picker-shortcuts.preview.tsx**

```tsx
"use client";

import { format } from "date-fns";
import { useState } from "react";

import {
  DatePicker,
  DatePickerPanel,
  DatePickerTrigger,
} from "@/foundations/ui/date-picker/date-picker";
import {
  DropdownDivider,
  DropdownItem,
} from "@/foundations/ui/dropdown/dropdown";

export default function DatePickerShortcutsPreview() {
  const [dateRange, setDateRange] = useState<[Date, Date] | null>(null);

  return (
    <DatePicker placement="bottom-start">
      <DatePickerTrigger className="w-80" placeholder="Select date range">
        {dateRange
          ? format(dateRange[0], "MM/dd/yyyy") +
            " - " +
            format(dateRange[1], "MM/dd/yyyy")
          : undefined}
      </DatePickerTrigger>
      <DatePickerPanel
        className="w-80"
        mode="range"
        value={dateRange}
        onDateChange={(dates: [Date, Date]) => {
          setDateRange(dates);
        }}
      >
        <DropdownDivider />
        <DropdownItem
          onSelect={() => {
            setDateRange([new Date(), new Date()]);
          }}
        >
          Today
        </DropdownItem>
        <DropdownItem
          onSelect={() => {
            setDateRange([
              new Date(new Date().setDate(new Date().getDate() - 1)),
              new Date(new Date().setDate(new Date().getDate() - 1)),
            ]);
          }}
        >
          Yesterday
        </DropdownItem>
        <DropdownItem
          onSelect={() => {
            setDateRange([
              new Date(new Date().setDate(new Date().getDate() - 7)),
              new Date(),
            ]);
          }}
        >
          Last 7 days
        </DropdownItem>
        <DropdownDivider />
        <DropdownItem
          className="text-red-500"
          onSelect={() => {
            setDateRange(null);
          }}
        >
          Clear
        </DropdownItem>
      </DatePickerPanel>
    </DatePicker>
  );
}

```

**src/foundations/ui/date-picker/examples/date-picker.preview.tsx**

```tsx
"use client";

import { format } from "date-fns";
import { useState } from "react";

import {
  DatePicker,
  DatePickerPanel,
  DatePickerTrigger,
} from "@/foundations/ui/date-picker/date-picker";

export default function DatePickerPreview() {
  const [selectedDate, setSelectedDate] = useState<Date | null>(null);

  return (
    <DatePicker placement="bottom-start">
      <DatePickerTrigger className="w-60" placeholder="Select date">
        {selectedDate ? format(selectedDate, "PPP") : undefined}
      </DatePickerTrigger>
      <DatePickerPanel
        className="w-72"
        value={selectedDate}
        onDateChange={(date: Date) => {
          setSelectedDate(date);
        }}
      />
    </DatePicker>
  );
}

```

**src/foundations/ui/calendar/calendar.tsx**

```tsx
"use client";

import { CaretLeftIcon, CaretRightIcon } from "@phosphor-icons/react";
import { add, format, isSameDay, isSameMonth } from "date-fns";
import { useMemo, useState } from "react";

import { Button } from "@/foundations/ui/button/button";
import { cn } from "@/lib/utils";

/**
 * Generate a matrix of dates for a given month
 * Dates from previous and next month are included and marked as negative numbers.
 *
 * @param year The year
 * @param month The month (1-12)
 * @param options Configuration options
 * @returns Matrix of dates. Each row is a week, each column is a day.
 */
const generateMonth = (
  year: number,
  month: number,
  options: {
    onlyCurrentMonthRows?: boolean;
    startWeekOn?: 0 | 1 | 2 | 3 | 4 | 5 | 6;
  } = {}
): readonly (readonly number[])[] => {
  const date = new Date(year, month - 1);
  const startWeekOn = options.startWeekOn ?? 1; // Default to Monday (1)
  const firstWeekDay = (date.getDay() - startWeekOn + 7) % 7;
  const daysInMonth = new Date(year, month, 0).getDate();
  const daysInPrevMonth = new Date(year, month - 1, 0).getDate();

  const generateDay = (index: number): number => {
    const currentDay = index - firstWeekDay + 1;
    if (currentDay <= 0) {
      return -(daysInPrevMonth + currentDay);
    } else if (currentDay > daysInMonth) {
      return -(currentDay - daysInMonth);
    }
    return currentDay;
  };

  const generateWeek = (weekIndex: number): readonly number[] =>
    Array.from({ length: 7 }, (_, i) => generateDay(weekIndex * 7 + i));

  const matrix = Array.from({ length: 6 }, (_, i) => generateWeek(i));

  return options.onlyCurrentMonthRows
    ? matrix.filter((week) => week.some((day) => day > 0))
    : matrix;
};

interface CalendarCommonProps extends React.ComponentPropsWithRef<"div"> {
  getIsDisabled?: (date: Date) => boolean;
  startWeekOn?: 0 | 2 | 1 | 3 | 4 | 5 | 6;
  locale?: Intl.LocalesArgument;
}

interface CalendarSingleProps extends CalendarCommonProps {
  value: Date | null;
  onDateChange: (date: Date) => void;
  mode?: "single";
}

interface CalendarRangeProps extends CalendarCommonProps {
  value: [Date, Date] | null;
  onDateChange: (dates: [Date, Date]) => void;
  mode: "range";
}

type CalendarProps = CalendarSingleProps | CalendarRangeProps;

type CalendarView = "days" | "months" | "years";

const sortDates = (dates: [Date, Date]): [Date, Date] => {
  return [...dates].sort((a, b) => a.getTime() - b.getTime()) as [Date, Date];
};

const Calendar = ({
  mode,
  onDateChange,
  value,
  getIsDisabled = () => false,
  startWeekOn = 0,
  locale = "en",
  className,
  ...props
}: CalendarProps) => {
  const [view, setView] = useState<CalendarView>("days");
  const [viewDate, setViewDate] = useState<Date>(
    mode === "range" ? value?.[0] || new Date() : value || new Date()
  );

  // used to track a date range while it's being selected
  const [transientRange, setTransientRange] = useState<[Date, Date] | null>(
    null
  );

  const [startDate, endDate] = useMemo(() => {
    if (transientRange) {
      return sortDates(transientRange);
    }

    if (!value) {
      return [null, null];
    }

    if (mode === "range") {
      return sortDates(value);
    }

    return sortDates([value, value]);
  }, [mode, value, transientRange]);

  const month = useMemo(() => {
    const matrix = generateMonth(
      viewDate.getFullYear(),
      viewDate.getMonth() + 1,
      {
        startWeekOn,
      }
    );

    return matrix.map((row, i) =>
      row.map((day) => {
        const year = viewDate.getFullYear();
        const month = viewDate.getMonth();
        const date = new Date(year, month, 1);

        if (i === 0 && day < 0) {
          date.setMonth(date.getMonth() - 1);
        } else if (day < 0) {
          date.setMonth(date.getMonth() + 1);
        }

        date.setDate(Math.abs(day));

        return date;
      })
    );
  }, [viewDate, startWeekOn]);

  const handleDaySelect = (date: Date) => {
    // not a range selection
    if (mode !== "range") {
      return onDateChange(date);
    }

    // start a range selection
    if (!transientRange) {
      return setTransientRange([date, date]);
    }

    // end selection
    setTransientRange(null);
    return onDateChange(sortDates([transientRange[0], date]));
  };

  const handleDayHover = (date: Date) => {
    if (mode !== "range" || !transientRange) return;

    setTransientRange([transientRange[0], date]);
  };

  return (
    <div className={cn("bg-background", className)} {...props}>
      {view === "years" && (
        <CalendarHeader
          onPrevious={() => setViewDate((prev) => add(prev, { years: -12 }))}
          onNext={() => setViewDate((prev) => add(prev, { years: 12 }))}
        >
          <HeaderTextButton
            className="flex items-center gap-1"
            onClick={() => setView("days")}
          >
            <span>{viewDate.getFullYear() - 5}</span>
            <span>{"–"}</span>
            <span>{viewDate.getFullYear() + 6}</span>
          </HeaderTextButton>
        </CalendarHeader>
      )}
      {view === "months" && (
        <CalendarHeader
          onPrevious={() => setViewDate((prev) => add(prev, { years: -1 }))}
          onNext={() => setViewDate((prev) => add(prev, { years: 1 }))}
        >
          <HeaderTextButton onClick={() => setView("years")}>
            {viewDate.getFullYear()}
          </HeaderTextButton>
        </CalendarHeader>
      )}
      {view === "days" && (
        <CalendarHeader
          onPrevious={() => setViewDate((prev) => add(prev, { months: -1 }))}
          onNext={() => setViewDate((prev) => add(prev, { months: 1 }))}
        >
          <div className="flex items-center gap-1 text-sm">
            <HeaderTextButton onClick={() => setView("months")}>
              {viewDate.toLocaleDateString(locale, { month: "long" })}
            </HeaderTextButton>
            <HeaderTextButton onClick={() => setView("years")}>
              {viewDate.getFullYear()}
            </HeaderTextButton>
          </div>
        </CalendarHeader>
      )}

      <div className="relative">
        {(view === "years" || view === "months") && (
          <div className="bg-background absolute inset-0 z-10 p-1">
            {view === "years" && (
              <div className="grid size-full grid-cols-3 grid-rows-4 p-0.5">
                {Array.from({ length: 12 }, (_, i) => {
                  const year = viewDate.getFullYear() - 5 + i;
                  const date = new Date(year, viewDate.getMonth(), 1);
                  return (
                    <YearMonthButton
                      key={i}
                      className="h-full"
                      onClick={() => {
                        setViewDate(date);
                        setView("months");
                      }}
                    >
                      {year}
                    </YearMonthButton>
                  );
                })}
              </div>
            )}
            {view === "months" && (
              <div className="grid size-full grid-cols-3 grid-rows-4 p-0.5">
                {Array.from({ length: 12 }, (_, i) => {
                  const date = new Date(viewDate.getFullYear(), i, 1);
                  return (
                    <YearMonthButton
                      key={i}
                      className="h-full"
                      onClick={() => {
                        setViewDate(date);
                        setView("days");
                      }}
                    >
                      {date.toLocaleDateString(locale, { month: "short" })}
                    </YearMonthButton>
                  );
                })}
              </div>
            )}
          </div>
        )}

        <div className="grid grid-cols-7">
          {Array.from({ length: 7 }, (_, i) => {
            const weekday = new Date(2024, 0, (i + startWeekOn) % 7);
            return (
              <div
                key={i}
                class
// ... truncated ...

```

**src/foundations/ui/calendar/examples/calendar-start-day.preview.tsx**

```tsx
"use client";

import { useState } from "react";

import { Calendar } from "@/foundations/ui/calendar/calendar";

export default function CalendarStartDayPreview() {
  const [selectedDate, setSelectedDate] = useState<Date | null>(null);

  return (
    <Calendar
      value={selectedDate}
      onDateChange={setSelectedDate}
      startWeekOn={1} // Start on Monday
    />
  );
}

```
